<!DOCTYPE html>
<html>
    <head>
<meta charset="UTF-8" />
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Método Simplex</title>
    <script src = "LPdefs.js"></script>
	<script src = "LPmethods.js"></script>
</head>
    
    <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" style="color: white" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home"
                aria-selected="true">Simplex</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" style="color: white" id="costo-tab" data-toggle="tab" href="#costo" role="tab" aria-controls="valorMarg"
                aria-selected="false">Costo de Oportunidad</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" style="color: white" id="valorMarg-tab" data-toggle="tab" href="#valorMar" role="tab" aria-controls="costo"
                aria-selected="false">Valor Marginal</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" style="color: white" id="sensibilidad-tab" data-toggle="tab" href="#sensibilidad" role="tab" aria-controls="sensibilidad"
                aria-selected="false">Analisis de Sensibilidad</a>
            </li>
    </ul>
          <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                      
                <div id="info1" class="py-5 text-center">
                  <h2>Método simplex</h2>
                  <p class="lead"> Escriba su problema de programacion lineal. Luego presione "Resolver".
                  </p>
                </div>
                <center>
                  <div id="input">
                    <form id="formulario">
                      <div class="col-md-3 mb-3">
                        ¿Qué desea hacer?
                        <select class="custom-select d-block w-100" id="objetivo">
                        <option	value ="Maximizar">Maximizar</option>
                        <option value="Minimizar">Minimizar</option>
                        </select>
                      </div>
                      <div class="col-md-3 mb-3">
                        <label for="funcion">Función: </label>
                        <input class="form-control" id="funcion" type="text" size="20">
                      </div>
                      <div class="col-md-3 mb-3">
                        <label for="cantVariable">¿Cuantas variables de decisión tiene el problema? </label>
                        <input class="form-control" id="cantVariable" type="text" size="20">
                      </div>	
                      <div class="col-md-3 mb-3">
                        <label for="cantRestriccion">¿Cuantas restricciones? </label>
                        <input class="form-control" id="cantRestriccion" type="text" size="20">
                      </div>	
                      
                        <button type="button" class="btn btn-primary"  onClick="CrearRelleno();">Aceptar</button>			
                        <p></p>
                        
                      
                    </form>
                    <form class="form-inline" id="cosas">		
                    </form>
                  </div>
                  <p>
                    Costo de oportunidad :
                  <div id="costoOportunidad"></div>
                  </p>
            
                  <p>
                    Valor marginal :
                    <div id="valorSlack"></div>
                  </p>
                
                  
                  <div id="info2" style="width:100%;text-align:center;margin:5px 0 5px 0">
                    Solución:
                  </div>
                  <div id="solutionout" style="text-align:left;background-color:white;width:95%;font-family:monospace;border:thin solid;padding:10px">
                    Una solución óptima (o mensaje) aparecerá aquí.
                  </div>
                  <div id="buttonsdiv" style="width:100%;text-align:center;margin:5px 0 5px 0">
                      <button class="btn btn-primary" onClick="Resolv();">Resolver</button>
                      &#160; &#160;
                      <button class="btn btn-secondary" onClick="clearAll();">Borrar todo</button>
                    
                    <br>&#160;<br>
                    
                    <div style="display: inline-block; vertical-align:middle; text-align:left">
                      <div class="custom-control custom-radio">
                      <input type="radio" name="displaytabl" id="noTabl" class="custom-control-input"> 
                      <label class="custom-control-label" for="noTabl">Ocultar las tablas. </label>
                      </div>
                      <div class="custom-control custom-radio">
                      <input class="custom-control-input" type="radio" checked="true" name="displaytabl" id="yesTabl"> 
                      <label class="custom-control-label" for="yesTabl">Mostrar las tablas (pasos).</label>
                      </div>
                      <div class="custom-control custom-radio">
                      <input class="custom-control-input" type="radio" name="displaytabl" id="andSolns"> 
                      <label class="custom-control-label" for="andSolns">Mostrar tablas y soluciones intermedias.</label>
                      </div>
                    </div>
                    &#160; &#160; 
                    Modo Tabla: <div style="display: inline-block; vertical-align:middle; text-align:left">
                      <div class="custom-control custom-radio">
                      <input type="radio" checked="true" name="modepicker" id="3" value="decimal" class="custom-control-input">
                      <label class="custom-control-label" for="3">decimal </label>
                      </div>
                      <div class="custom-control custom-radio">
                      <input class="custom-control-input" type="radio" name="modepicker" id="2" value="fraction" class="custom-control-input">
                      <label class="custom-control-label" for="2">fracción</label>
                      </div>
                      <div class="custom-control custom-radio">
                      <input class="custom-control-input" type="radio" name="modepicker" id="1" value="integer" class="custom-control-input">
                      <label class="custom-control-label" for="1">entero</label>
                      </div>
                    </div>
                      &#160; &#160;
            
                     Redondeo: <input type="text" id="accuracyDig" size="1" value="6"> dígitos significativos
                      &#160; &#160;
                  </div>
                  <div id="outputarea" style="width: 95%; overflow-x: scroll; background-color:white; font-family:monospace; border: thin solid; padding: 10px; text-align:left">
                    Las tablas del Método Simplex apareceran aquí.
                  </div>
                  <div id="spacer" style="height:20px"></div>
                </center>
              
             
            </div>
            <div class="tab-pane fade" id="costo" role="tabpanel" aria-labelledby="costo-tab">
                <center>
                    <div class="w-75 p-3">
                                     
                    <h2> Costo de Oportunidad</h2>
              <p class="text-justify">Nos indica cuanto disminuirá el funcional si se fabrica una unidad de ese producto. Por supuesto, para aquellos
              productos que están en la base, el costo de oportunidad es cero, porque ya se estan fabricando. 
              Para aquellos productos que no están en la base, es decir su Xi vale cero, el costo de oportunidad puede ser 
              Cero: lo que indica soluciones alternativas, pues se tiene igual valor de funcional con dicha variable en la base que 
              con la base actual, que no la contiene.
              Negativo: una disminución negativa del funcional es un aumento del mismo, estamos en el caso en el que esa variable es 
              cadidata de entrar en la base.
              Positivo: si nos obligamos a producir una unidad de ese producto nuestro funcional disminuiría en un valor igual al producto 
              entre la cantidad de unidades fabricadas y dicho costo de oportunidad.</p>
                    </div>
                </center>
            
            </div>
            <div class="tab-pane fade" id="valorMar" role="tabpanel" aria-labelledby="valorMar-tab">
                <center>
                    <div class="w-75 p-3">
                                     
                    <h2> Valor Marginal</h2>
              <p class="text-justify">El valor marginal de los recursos indica cuál sería el aumento del funcional si tuvieramos una unidad más de ese 
              recurso disponible. 
              Entonces si se tuviera que pagar para obtener una unidad de ese recurso no se pagaría más de esa cifra porque 
              sino se perdería dinero. Así, bien se ve porque el valor marginal de los recursos cuyas variables están en la base 
              es igual a cero. Si están en la base es porque tienen sobrante y no se esta dispuesto a pagar por tener más de algo 
              que en realidad nos sobra.
              En el caso de los recursos saturados, cuyas variables no figuran en la base, el valor marginal puede ser:
              Cero: alternativas
              Negativo: candidato a entrar en la base.
              Positivo: se esta dispuesto a pagar ese valor marginal para obtener el recurso.</p>
                    </div>
                </center>
            </div>
              <div class="tab-pane fade" id="sensibilidad" role="tabpanel" aria-labelledby="sensibilidad-tab">
                  <center>
                <div class="w-75 p-3">
                                 
                <h2> Análisis de Sensibilidad</h2>
                
               <p class="text-justify">El análisis de sensibilidad busca determinar los efectos que se producen en la solución óptima al realizar cambios 
                en cualquiera de los parámetros del modelo de programación lineal planteado inicialmente. Entre los cambios que se 
                investigan están: los cambios en los coeficientes de las variables en la función objetivo tanto para variables
                básicas como para las variables no básicas, cambios en los recursos disponibles de las restricciones, variación de
                los coeficientes de utilización en las restricciones e introducción de una nueva restricción.</p>
                
               <p class="text-justify"> El objetivo principal del análisis de sensibilidad es identificar el intervalo permisible de variación en los cuales 
                las variables o parámetros pueden fluctuar sin que cambie la solución optima.  Sin embargo, así mismo se identifica 
                aquellos parámetros sensibles, es decir, los parámetros cuyos valores no pueden cambiar sin que cambie la solución
                óptima.  Los investigadores de operaciones tienden a prestar bastante atención a aquellos parámetros con holguras
                reducidas en cuanto a los cambios que pueden presentar, de forma que se vigile su comportamiento para realizar los 
                ajustes adecuados según corresponda y evitar que estas fluctuaciones pueden desembocar en una solución no factible.
              </p>
                <h4>Cambios que afectan la factibilidad</h4>
                <p class="text-justify">La factibilidad de la solución óptima en el momento sólo puede variar si 1) cambia el lado derecho de las restricciones, o 2) 
                se agrega al modelo una restricción nueva. En ambos casos se tiene no factibilidad cuando al menos un elemento del lado derecho 
                en la tabla óptima se hace negativo; esto es, una o más de las variables básicas actuales se vuelve negativa.</p>

                <h5>Cambios en el lado derecho</h5>
                <p >Estos cambios requieren volver a calcular el lado derecho de la tabla, usando la Fórmula 1:</p>
                <img src="/home/flor/Documentos/Facultad/2019/Inv_Operativa/TPI/test/1.png" class="rounded mx-auto d-block">
                <p>Recuerde que el lado derecho de la tabla expresa los valores de las variables básicas.</p>

                <h5>Intervalo de factibilidad de los elementos del lado derecho</h5>
                <p class="text-justify">Otra forma de examinar el efecto de cambiar la disponibilidad de los recursos (es decir, el vector del lado derecho) es 
                  determinar el intervalo para el cual la solución actual o del momento permanece factible.</p>
                
                  <h5>Adición de nuevas restricciones</h5>
                  <p class="text-justify">La adición de una nueva restricción a un modelo existente puede llevar a uno de los dos casos siguientes:
                  </p>
                  <li class="p-3 mb-2 bg-light text-dark">La nueva restricción es redundante, lo que quiere decir que se satisface con la solución óptima actual y, por consiguiente, se puede eliminar por completo del modelo.</li>
                  <li class="p-3 mb-2 bg-light text-dark">La solución actual viola la nueva restricción, y en este caso se puede aplicar el método simplex dual para recuperar la factibilidad.</li>
                  <p class="text-justify">Observe que la adición de una nueva restricción, como en el caso 2, nunca puede mejorar el valor objetivo óptimo actual.</p>
                
                  <h4>Cambios que afectan la optimalidad</h4>
                  <h5>Cambios en los coeficientes de la función objetivo</h5>
                  <p class="text-justify">Esos cambios sólo afectan la optimalidad de la solución. Por consiguiente requieren recalcular los coeficientes del renglón z, con el siguiente procedimiento:
                    </p>
                    <ol>
                        <li  class="p-3 mb-2 bg-light text-dark">Calcular los valores duales con los métodos 1 y 2.</li>
                        <li  class="p-3 mb-2 bg-light text-dark">Usar los nuevos valores duales en la fórmula 2, para determinar los nuevos coeficientes en el renglón z.</li>
                    </ol>
                  <p>Se presentarán dos casos:</p>
                  <div class="alert alert-primary" role="alert">El nuevo renglón de z satisface la condición de optimalidad, y la solución permanece sin cambio (sin embargo, el valor objetivo óptimo puede cambiar).</div>
                  <div class="alert alert-primary" role="alert">La condición de optimalidad no se satisface, y en ese caso se aplica el método simplex (primal) para recuperar la optimalidad.</div>

                  <h5>Intervalo de optimalidad de los coeficientes objetivos</h5>
                  <p class="text-justify">Otra forma de investigar el efecto de los cambios en los coeficientes de la función objetivo es calcular el intervalo para el que cada coeficiente individual mantenga la solución
                    óptima actual. Esto se hace reemplazando el cj actual con cj+dj, donde dj representa la cantidad (positiva o negativa) de cambio.</p>
                    
                  <h5>Adición de una nueva actividad</h5>
                  <p class="text-justify">La adición de una nueva actividad en un modelo de programación lineal equivale a agregar una nueva variable. En forma intuitiva, la adición de una nueva actividad sólo es deseable si es rentable, 
                    esto es, si mejora el valor óptimo de la función objetivo. Esta condición se puede verificar aplicando la fórmula 2, a la nueva actividad. Como esa nueva actividad no es todavía parte de la solución, 
                    se puede considerar como una variable no básica. Eso quiere decir que los valores duales asociados con la solución actual permanecen invariables.</p>
                     
                  <p class="text-justify">Si la fórmula 2 indica que la nueva actividad satisface la condición de optimalidad, la actividad no es rentable.
                     En caso contrario, es mejor tener en cuenta la nueva actividad.</p>
                  <p class="text-justify">El caso de agregar una actividad nueva también abarca al caso en el que se hicieron cambios en los usos de los recursos, en una actividad 
                    existente. En forma específica se puede considerar a x7 como si al principio tuviera un coeficiente de objetivo cero y uso cero
                     de los tres recursos, y que esos valores cero se cambiaron a los nuevos valores que se dan para x7. Por esta razón no se describirá por separado el caso de cambiar los coeficientes 
                     de restricción de una variable existente.</p>
                      
                </div>
                </center>
              </div>


          </div>

          <script>
            lp_reportErrorsTo=lp_reportSolutionTo="solutionout";
            var lp_demo_exampleNumber=0;
            var lp_demo_accuracy=6;
            var lp_demo_mode="decimal";
            //var lp_demo_verboseLevel=lp_verbosity_none;
            var exampleStr = [
            "Maximize p = (1/2)x + 3y + z + 4w subject to \nx + y + z + w <= 40\n2x + y - z - w >= 10\nw - y >= 12"
            ,
            "minimize z = 900x1 + 1400x2 + 700x3 + 1000x4 + 1700x5 + 900x6 subject to\nx1 + x2 + x3 <= 10\nx4 + x5 + x6 <= 10\nx1 + x4 >= 6\nx2 + x5 >= 4\nx3 + x6 >= 4\nx4 - x6 <= 0"
            ,
            
            "Maximize p = (1/2)x + 3y + z + 4w subject to \nx + y + z + w <= 40 \n2x + y - z - w >= 10 \nw - y >= 12 \ninteger w, x, y, z"
            ,
            "Maximize p = x + 2y + 3z subject to \nx + y <= 20.5\ny + z <= 20.5\nx + z <= 30.5\ninteger x, y, z" ,
            "Maximize p = x+y\nx+y<=.75\nx+y>=.5\ninteger x,y"]
        
            function showExamples() {
              document.getElementById("inputarea").value=exampleStr[lp_demo_exampleNumber%exampleStr.length];
              lp_demo_exampleNumber++;
            }
        
            function clearAll() {
              document.getElementById("inputarea").value="";
              document.getElementById("solutionout").innerHTML="Una solución óptima (o mensaje) aparecerá aquí.";
              document.getElementById("outputarea").innerHTML="Las tablas del Método Simplex apareceran aquí.";
            }
        
            function clearOutput() {
              document.getElementById("outputarea").innerHTML="Las tablas del Método Simplex apareceran aquí.";
            }
            
            function showOutput( str ) {
              document.getElementById("outputarea").innerHTML = str;
            }
            
            function showSolution( str ) {
              document.getElementById("solutionout").innerHTML = str;
              //console.log(str); este seria el lo que me da z y x1, x2
            }
        
            /*
            Utilizar estas restricciones
            5x1 + 8x2 <= 90
            x2 <= 40
            */
            // FILA DEL Z (Muestra los costo de oportunidad y la slack)
            function showFilaZ( filafinalZ) {
              var posicion = filafinalZ.length; //tamaño
              var mostrar = filafinalZ[posicion-1]; // me devuelve el ultima fila
              var cOportrunidad = "";
              var slack = "";
              var cantidadVariable = 2; // cuando tengamos el id de la cantidad de variables se le puede colocar aca
              for (var i=1; i < ((mostrar.length) -2); i++){
                if(i<= cantidadVariable){
                cOportrunidad = cOportrunidad + "Producto "+[i]+":"+" "+ mostrar[i] + "<br>";
                }else{
                slack = slack +" "+ mostrar[i] + "<br>";
                }
              }
                
              document.getElementById("costoOportunidad").innerHTML = cOportrunidad;
              document.getElementById("valorSlack").innerHTML = slack;
            }
        
            function adjustAccuracy() {
              var inAcc=parseInt(document.getElementById("accuracyDig").value);
              if ( (inAcc<=0)||(inAcc>13)||(isNaN(inAcc)) ) {
                alert("Must be in integer in the range 0-13")
                document.getElementById("accuracyDig").value=6;
              }
              else lp_demo_accuracy = inAcc;
            }
        
            function setMode() {
              lp_demo_mode=parseInt(document.querySelector('input[name="modepicker"]:checked').id); // ids are conveniently set to equal the mode
            }
        
            function setShowTabl() {
              var theId = document.querySelector('input[name="displaytabl"]:checked').id;
              switch ( theId ) {
                case "yesTabl":		lp_demo_verboseLevel = lp_verbosity_tableaus; break;
                case "andSolns":	lp_demo_verboseLevel = lp_verbosity_solutions; break;
                default:			lp_demo_verboseLevel = lp_verbosity_none; break;
              }
        // 			lp_demo_verboseLevel = (theId=="yesTabl") ? lp_verbosity_tableaus : lp_verbosity_none;
            }
          </script>

          <script>
            function Resolv() {
              var ob = document.getElementById("objetivo").value; //variable ob toma el valor del cuadro de texto objetivo
              var f = document.getElementById("funcion").value; //variable f toma el valor del cuadro de texto funcion
              var r = document.getElementById("restriccion").value; //variable r toma el valor del cuadro de texto restriccion
          
              var ArrayFormateado;
              const subject = " subject to ";
          
              
              if (ob == "Maximizar"){
                ob = "Maximize ";
              }else{
                ob = "minimize ";
              }
          
            ArrayFormateado = `${ob}${f}${subject}${r}`; //arrayformateado guarda los datos del problema, separados
            console.log({ArrayFormateado});
            clearOutput();
                    adjustAccuracy();setMode();setShowTabl();
                    var Q = new lpProblem( ArrayFormateado); //crea un objeto lpProblem a partir de arrayformateado
                    lp_verboseLevel=lp_demo_verboseLevel;
                    Q.mode=lp_demo_mode;
                    Q.sigDigits=lp_demo_accuracy;
                    try{Q.solve()} //acá llama a solve para el problema
                    finally{showOutput( lp_trace_string );showSolution( Q.solutionToString() ); showFilaZ(filaZ)} //muestra la solución como string, también los pasos intermedios
            }
            
            function CrearRelleno(){
              var cantidadVariable = document.getElementById("cantVariable").value;
              var cantidadRestricciones= document.getElementById("cantRestriccion").value;
              var rellenoV = "";
              
            
              for (var i = 1; i <= (cantidadRestricciones) ; i++) {//filas
                
                rellenoV += ' <div class="form-group row">';
                for (var j = 1; j <= (cantidadVariable) ; j++) {//colmunas
                  rellenoV += `<input type="text" class="form-control" > 
                           x`+[j]+' + ';
                  
                }
                
                rellenoV = rellenoV.slice(0,-2); //dame todo el string menos el ultimo caracter
                rellenoV += ` <select class="custom-select d-block w-20"  id="opcion">
                      <option	value ="menor_igual">≤</option>
                      <option value="mayor_igual">≥</option>
                      <option value="igual">=</option>
                      </select>
                      <input type="text" class="form-control" >`;
          
                rellenoV += '</div>';
              }
          
            
              document.getElementById("cosas").innerHTML = rellenoV;
          
            }
            </script>
            <style>
              #cosas {
                
                margin: 0 auto;
          
                display: inline-block;
                
              }
              .nav-tabs{
                background-color:#3c6eb4;
              }

              .btn-primary{
                background-color:#3c6eb4;
              }
                  
            </style>
</html>
